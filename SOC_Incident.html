<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>SOC Intelligence Console</title>
    <style>
        :root {
            --primary: #6366f1;
            --bg-dark: #0f172a;
            --card-bg: #1e293b;
            --text-gray: #94a3b8;
            --text-light: #f8fafc;
            --border: #334155;
            --danger: #ef4444;
            --success: #22c55e;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Inter', sans-serif;
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-light);
            display: flex;
            justify-content: center;
            padding: 40px 20px;
            min-height: 100vh;
        }

        .dashboard {
            width: 100%;
            max-width: 1100px;
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            border-bottom: 1px solid var(--border);
            padding-bottom: 20px;
        }

        h1 {
            font-size: 24px;
            letter-spacing: -0.5px;
        }

        h1 span {
            color: var(--primary);
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
            position: relative;
        }

        label {
            font-size: 11px;
            font-weight: 700;
            color: var(--text-gray);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        input,
        select,
        textarea {
            background: #0f172a;
            border: 1px solid var(--border);
            color: white;
            padding: 12px 16px;
            border-radius: 10px;
            font-size: 14px;
        }

        input[readonly] {
            background: rgba(15, 23, 42, 0.5);
            color: var(--text-gray);
            cursor: not-allowed;
        }

        .edit-link {
            position: absolute;
            right: 10px;
            top: 32px;
            font-size: 11px;
            color: var(--primary);
            cursor: pointer;
            display: none;
            font-weight: bold;
        }

        .btn {
            cursor: pointer;
            border-radius: 10px;
            font-weight: 700;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: 0.2s;
        }

        .btn-main {
            background: var(--primary);
            color: white;
            width: 100%;
            padding: 16px;
            font-size: 16px;
            margin-top: 10px;
        }

        .btn-main:hover {
            background: #4f46e5;
            transform: translateY(-1px);
        }

        .ti-results {
            margin-top: 25px;
            display: none;
        }

        .ti-item {
            background: #111827;
            border-left: 4px solid var(--primary);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            font-size: 13px;
        }

        .report-area {
            margin-top: 30px;
            display: none;
        }

        .report-content {
            background: #0f172a;
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 25px;
            white-space: pre-wrap;
            font-family: 'Fira Code', monospace;
            font-size: 13px;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        #loading {
            display: none;
            text-align: center;
            margin: 20px 0;
            color: var(--primary);
            font-weight: bold;
        }

        /* Footer Style */
        footer {
            margin-top: 40px;
            text-align: center;
            font-size: 12px;
            color: var(--text-gray);
            border-top: 1px solid var(--border);
            padding-top: 20px;
        }
    </style>
</head>

<body>

    <div class="dashboard">
        <header>
            <h1>üõ°Ô∏è SOC <span>Intelligence</span> Console</h1>
            <button class="btn"
                style="background:transparent; color:var(--text-gray); border:1px solid var(--border); padding:5px 15px"
                onclick="location.reload()">Reset</button>
        </header>

        <label style="margin-bottom:10px; display:block">üîê Intelligence API Vault</label>
        <div class="grid">
            <div class="input-group">
                <label>AI Key (Gemini/ChatGPT)</label>
                <input id="aiKey" type="password" placeholder="Paste & Press Enter">
                <span id="editAi" class="edit-link" onclick="unlockKey('aiKey')">Edit</span>
            </div>
            <div class="input-group">
                <label>AbuseIPDB Key</label>
                <input id="abuseKey" type="password" placeholder="Optional TI Key">
                <span id="editAbuse" class="edit-link" onclick="unlockKey('abuseKey')">Edit</span>
            </div>
            <div class="input-group">
                <label>VirusTotal Key</label>
                <input id="vtKey" type="password" placeholder="Optional TI Key">
                <span id="editVt" class="edit-link" onclick="unlockKey('vtKey')">Edit</span>
            </div>
            <div class="input-group">
                <label>AlienVault Key</label>
                <input id="otxKey" type="password" placeholder="Optional TI Key">
                <span id="editOtx" class="edit-link" onclick="unlockKey('otxKey')">Edit</span>
            </div>
        </div>

        <div class="grid">
            <div class="input-group">
                <label>Incident Rule</label>
                <select id="incidentType"></select>
            </div>
            <div class="input-group">
                <label>Model Selector</label>
                <select id="modelSelect">
                    <optgroup label="Gemini 2.5/2.0">
                        <option value="models/gemini-2.5-flash">models/gemini-2.5-flash</option>
                        <option value="models/gemini-2.5-pro">models/gemini-2.5-pro</option>
                        <option value="models/gemini-2.0-flash">models/gemini-2.0-flash</option>
                    </optgroup>
                    <optgroup label="OpenAI">
                        <option value="gpt-4o">gpt-4o</option>
                    </optgroup>
                </select>
            </div>
        </div>

        <div class="input-group" style="margin-bottom:20px">
            <label>Unmasked RAW Logs</label>
            <textarea id="rawLogs" placeholder="Paste full logs here..." style="min-height:200px"></textarea>
        </div>

        <button class="btn btn-main" onclick="runSOCEngine()">üöÄ Run Analysis Engine</button>
        <div id="loading">Drafting report...</div>

        <div class="ti-results" id="tiSection">
            <div id="tiContent"></div>
        </div>

        <div class="report-area" id="reportSection">
            <div class="report-content" id="reportContent"></div>
            <button class="btn btn-main" style="background:#475569" onclick="copyReport()">üìã Copy Report</button>
        </div>

        <footer>
            ¬© 2026 All Rights Reserved | Maveera
        </footer>
    </div>

    <script>
        // FULL LIST OF 200+ INCIDENTS PRESERVED
        const INCIDENTS = ["No logs from a device", "Multiple Logon Failures: Misc App .", "Multiple Login Failures: Net Device", "Failed VPN Logon From Outside My Country", "High Process CPU: Server", "Multiple Logon Failures: Web Server", "Server Disk Latency - Warning", "Brute Force App Login Success .", "Permitted-Traffic from Emerging Threat IP List", "UEBA AI detects unusual process stopped", "UEBA Policy detects removable media write", "Suspicious Logon Failure without following successful login", "FortiSIEM Agent Operational Error", "Multiple Logon Failures: VPN", "Server Installed Software - Change", "privilege user account modification -vip", "Multiple Logon Failures: Same Src and Dest and Multiple Accounts", "Unauthorized_Logon_to_ADCS_Servers_by_Non_Administrators", "Excessive file changes on a host: Potential Ransomware", "Server Installed Software Change", "Windows: Windows Update Error", "FortiSIEM-Agent Operational Error", "FortiGate: Config Change was Detected", "UEBA AI detects unusual file deletion", "No performance metrics from a device", "Missing a specific performance metric from a device", "UEBA AI detects unusual file reading", "Server Memory - warning", "UEBA AI detects unusual file creation", "Missing specific performance metric from a device", "Windows: AD User Enumeration", "Concurrent Failed Authentications To Same Account From Multiple Countries", "Heavy TCP Host Scan On Fixed Port", "UEBA AI detects unusual file writing", "Large-Outbound Transfer", "Windows Logging Service Shutdown", "Sudden Decrease in Reported Events From A Host", "Sudden Increase in Successful Logons To A Host", "Windows: Windows Service Terminated With Error", "Permitted Traffic from Emerging Threat IP List", "Office365 - Brute Force Login Attempts - Same User", "Server Down: No Ping Response", "UEBA AI detects unusual process created", "System Collector Event Delayed", "Multiple logon failure on privilege users", "Office365: Brute Force - Login Attempts Same Source", "Large Outbound Transfer To Outside My Country", "High Process CPU-Server", "Windows-User Account Enabled", "Multiple Logon - Failures: Misc App", "Server Memory - Critical", "Windows - User Deleted", "Windows - User Password Changed", "Windows - User Created", "Account Locked: Server", "Server Down: No Ping Response 7/19/2024", "Windows - User Added to Groups", "Windows-User Account Properties Changed", "Windows - User Removed from Groups", "Concurrent Failed Authentications To Same Account From Multiple Cities of the same Country", "Windows: NTLMv1 Logon Between Client and Server", "Multiple Logon Failures: Misc App", "UEBA Policy detects potential leaver editing a CV at work", "Server Installed Software - Change", "UEBA Policy detects ransomware file types", "UEBA AI-detects unusual file reading", "Windows-User Account Disabled", "Windows-User Password Changed", "UEBA-Policy detects potential leaver editing a CV at work", "Sudden Increase in Network Interface Traffic", "Windows User Password Changed", "Traffic to bogon networks", "Windows Groups Changed", "Permitted Traffic- from FortiGuard Malware IP List", "UEBA - AI detects unusual process created", "Brute Force Host Login Success", "Windows User Account Properties Changed", "Windows Account Unlocked", "Windows Removable Media Inserts", "Network -Intf Error Critical", "Windows User Added to Groups", "Windows User Account Enabled", "Windows: Hidden Local User Creation", "Office365: Brute Force Login Attempts - Same User", "Traffic to FortiGuard - Malware IP List", "Heavy TCP Host Scan", "UEBA AI detects unusual file renamed", "Server Disk Space - Critical", "Windows: Locked Workstation", "Windows User Created", "Brute Force - Domain Login Success", "Server CPU Critical.", "Windows: Remote Access Tool Services Have Been Installed - System", "Sudden Increase in Reported Events From A Host", "Windows: Remote Access Tool Services Have Been Installed - Security", "Windows User Removed from Groups", "Brute Force App Login Success", "Server Intf Error Critical", "UEBA Policy detects potential pirated media", "Uncommon VPN Login", "Windows: A Member Was Removed From a Security-Enabled Global Group", "Windows: Local User Creation", "UEBA AI detects unusual file download", "UEBA Policy detects suspicious applications", "Windows User Deleted", "Sudden Increase In DNS Requests From - A Specific Host", "Server Disk Latency Warning", "FortiAnalyzer: No logs received from a device in 4 hours", "Ransomware - detected on a host", "Sudden Increase in Failed Logons To A Host", "Sudden Increase in Firewall Denied Outbound Traffic To A Specific TCP/UDP port", "Windows: A Member Was Added to a Security-Enabled Global Group", "Windows User Account Disabled", "Traffic to bogon - network", "Excessive End User-DNS Queries", "Sudden Increase in Server Process Count", "Heavy UDP Port Scan: Single Host", "MS 365 Defender: Generic Alert", "Windows: Failed Logon From Public IP", "Server Intf Util Warning", "Windows: A Member Was Added-to a Security-Enabled Global Group", "Group Policy Object Created", "Windows: Possible DC Shadow Attack", "Outbound Permitted Traffic To FortiGuard Malware IP List - FortiGate FW", "Large - Outbound Transfer", "Multiple IPS-Detected Scans From Same Src", "Outbound insecure protocol traffic from non guest network detected", "Excessive Denied Connections From Same Src", "PH_RULE_O365_AddMemberToRole", "Linux: Kernel Module Modification", "UEBA AI detects unusual file upload", "Server Intf Util - Critical", "Stealth Scan - using a tool", "Large- Outbound Transfer", "Sudden Increase in Network Interface Errors", "Server Memory Critical", "Large Outbound - Transfer To Outside My Country", "Sudden Increase in Firewall Denied Inbound Traffic To A Specific TCP/UDP port", "Windows: Active Directory Replication from Non Machine Account", "ICMP Flood From Same Source", "Windows: Mimikatz DC Sync", "Network Device Down: no ping response", "Server Intf Error Warning", "User Login Success from other countries -- Application", "Windows: Application Uninstalled", "Windows: DPAPI Domain Master Key Backup Attempt", "Windows: External Disk Drive or USB Storage Device", "Linux: Setgid Bit Set via chmod", "Linux: Setuid Bit Set via chmod", "UEBA Policy detects removable media read", "Sudden Increase in User Login Volume", "Windows:Server Paging File Usage Critical", "Windows - Service Installed By Unusual Client - System", "ICMP Flood From - Same Source", "User added to Administrator Group", "Sudden Change In DNS Data Transfer Pattern From A Specific Host", "FortiGate: Admin User Deleted", "Remote Desktop traffic from Internet", "MS 365 Defender: Incident Triggered", "High Severity MS 365 Defender: Incident Triggered", "Office365: Move To Folder Inbox Rule Created", "Group - Policy Object Modified", "Heavy TCP Host Scan .", "Large Outbound - Transfer To Outside My Country", "Office365: Brute Force Login Attempts : Same User", "Windows: Add or Remove Computer from DC", "Heavy UDP Host Scan On Fixed Port", "Office365: Suspicious File Type Uploaded", "Server Intf Util Critical", "Sudden Increase in System Memory Usage", "Inbound insecure protocol traffic detected", "FortiGate: Admin User Added", "Large Inbound Transfer From Outside My Country", "Transient Windows Account Usage", "End User DNS Queries to Unauthorized DNS Servers", "Windows: Unauthorized System Time Modification", "Sudden-User Location Change", "Website access - policy violation", "AD_Group_Modification_Detected", "Account_created_by_the_Privilege_users", "License Issues", "Outbound Permitted Traffic To Emerging Threat IP List - FortiGate FW", "Sudden Increase in Outbound Firewall Aggregate Denies", "Windows: Active Directory User Backdoors", "Concurrent Successful Authentications To Same Account From Multiple Cities of the same Country", "Server Degraded: Lossy Ping Response", "Heavy TCP Port Scan: Single Destination", "High Process CPU: Network Device", "VNC traffic from Internet", "High Severity MS 365 Defender Generic Alert", "Multiple Windows Accounts Disabled by Administrator", "Office365: Mailbox SendAs or SendOnBehalf has occurred", "Office365: Set-Mailbox Forwarding Action Created", "Windows: Possible Shadow Credentials Added", "Ransomware outbreak detected", "Windows: SCM Database Handle Failure", "Server Memory Warning", "Successful Account Activity On a Prior Disabled Account", "Windows: Service Installation in Suspicious Folder", "Linux: Unusual Process Execution from Temp", "MS 365 Defender: Malware Detected", "Sudden Change In DNS -Data Transfer Pattern From A Specific Host", "Suspicious_Certificate_Template_Modifications", "Traffic to Emerging Threat-IP List", "Windows: Generic Password Dumper Activity on LSASS . cloned", "Windows: Outgoing Logon with New Credentials.", "Windows - Service Installed By Unusual Client - Security", "Windows - User Password Changed - VIP", "CheckPoint Harmony - Found Communication from an Malicious IP", "FortiGate - Admin User Added", "Office365 - Suspicious File Type Uploaded", "User added to Remote Desktop User Group", "Sudden Increase In Firewall Connections", "Azure Resource Group Deleted", "Network Device Degraded: Lossy Ping Response", "Multiple Logon Failures: Database", "Failed Account Activity On Prior Disabled Account", "Permitted Traffic from FortiGuard Malware IP List", "Outbreak: FortiManager Command Execution Vulnerability Detected on Device", "Heavy UDP Host Scan", "High Severity Inbound Permitted IPS Exploit", "DoS Attack detected by NIPS", "Office365: Strong Authentication Disabled for a User", "Server Disk Latency Critical", "SNMP Service Unavailable", "Traffic to Emerging Threat-IP List", "Windows: Tap Driver Installation", "UEBA AI detects unusual file movement", "UEBA Policy detects ransomware note", "MS 365 Defender: Suspicious Activity Detected", "Windows User Account Name Changed", "Sudden - User Location Change", "Suspicious_Certificate_Enrollment_With_Elevated_Privileges", "Suspicious - Logon Failure without following successful login", "Windows - Groups Changed", "Windows: Replay Attack Detected rule", "Brute Force - Host Logon Failure - Domain Alert"];

        const STORAGE_KEYS = { aiKey: 'soc_ai', abuseKey: 'soc_abuse', vtKey: 'soc_vt', otxKey: 'soc_otx' };

        window.onload = () => {
            const iSelect = document.getElementById('incidentType');
            INCIDENTS.sort().forEach(i => iSelect.innerHTML += `<option value="${i}">${i}</option>`);
            Object.keys(STORAGE_KEYS).forEach(id => loadKey(id));
        };

        function loadKey(id) {
            const val = localStorage.getItem(STORAGE_KEYS[id]);
            if (val) {
                document.getElementById(id).value = val;
                document.getElementById(id).readOnly = true;
                const btnId = 'edit' + id.charAt(0).toUpperCase() + id.slice(1, -3);
                if (document.getElementById(btnId)) document.getElementById(btnId).style.display = 'block';
            }
        }

        function lockKey(id) {
            const input = document.getElementById(id);
            if (input.value.trim().length > 5) {
                localStorage.setItem(STORAGE_KEYS[id], input.value.trim());
                input.readOnly = true;
                const btnId = 'edit' + id.charAt(0).toUpperCase() + id.slice(1, -3);
                if (document.getElementById(btnId)) document.getElementById(btnId).style.display = 'block';
            }
        }

        function unlockKey(id) {
            const storage = STORAGE_KEYS[id];
            document.getElementById(id).readOnly = false;
            document.getElementById(id).value = "";
            localStorage.removeItem(storage);
            const btnId = 'edit' + id.charAt(0).toUpperCase() + id.slice(1, -3);
            if (document.getElementById(btnId)) document.getElementById(btnId).style.display = 'none';
            document.getElementById(id).focus();
        }

        ['aiKey', 'abuseKey', 'vtKey', 'otxKey'].forEach(id => {
            document.getElementById(id).addEventListener('keydown', (e) => { if (e.key === 'Enter') lockKey(id); });
        });

        async function runSOCEngine() {
            const logs = document.getElementById('rawLogs').value.trim();
            const rule = document.getElementById('incidentType').value;
            const aiKey = document.getElementById('aiKey').value.trim();
            const model = document.getElementById('modelSelect').value;
            const loader = document.getElementById('loading');

            if (!logs || !aiKey || !rule) return alert("Logs, Rule, and AI Key are mandatory.");
            loader.style.display = 'block';
            document.getElementById('tiSection').style.display = 'none';
            document.getElementById('reportSection').style.display = 'none';

            const abuseK = document.getElementById('abuseKey').value.trim();
            const ips = [...new Set(logs.match(/\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b/g) || [])];

            if (abuseK && ips.length > 0) {
                const tiContent = document.getElementById('tiContent');
                tiContent.innerHTML = "";
                let publicFound = false;
                for (const ip of ips) {
                    if (!/^(10|127|172\.(1[6-9]|2[0-9]|3[0-1])|192\.168)\./.test(ip)) {
                        publicFound = true;
                        try {
                            const res = await fetch(`https://api.abuseipdb.com/api/v2/check?ipAddress=${ip}`, { headers: { 'Key': abuseK, 'Accept': 'application/json' } });
                            const data = await res.json();
                            tiContent.innerHTML += `<div class="ti-item">üõ°Ô∏è AbuseIPDB [${ip}]: Score ${data.data.abuseConfidenceScore}% | ISP: ${data.data.isp}</div>`;
                        } catch (e) { }
                    }
                }
                if (publicFound) document.getElementById('tiSection').style.display = 'block';
            }

            const prompt = `Act as a SOC Analyst. Draft a technical investigation for: "${rule}".
  
  RULES:
  - NO email headers (Subject, To, From, Date, Incident ID).
  - START DIRECTLY with: "We have observed that the ${rule} incident for the user mentioned below. Attached log details for your reference."
  
  OUTPUT FORMAT:
  We have observed that the ${rule} incident for the user mentioned below. Attached log details for your reference.
  
  Details:
  Reporting IP: [Extract IP]
  User: [Extract User]
  Domain: [Extract Domain]
  Target Domain: [Extract Hostname]
  
  Observation:
  [A technical paragraph explaining the finding based on Event IDs/Logs.]
  
  Remediation:
  [Clear actionable steps.]
  
  Note: [Provide any specific impact related to remediation.]

  LOG DATA: ${logs.slice(0, 5000)}`;

            try {
                let response;
                if (model.startsWith('models/')) {
                    response = await fetch(`https://generativelanguage.googleapis.com/v1beta/${model}:generateContent?key=${aiKey}`, {
                        method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                    });
                } else {
                    response = await fetch('https://api.openai.com/v1/chat/completions', {
                        method: 'POST', headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${aiKey}` }, body: JSON.stringify({ model: model, messages: [{ role: "user", content: prompt }] })
                    });
                }

                const data = await response.json();
                if (!response.ok) throw new Error(data.error?.message || "API Error");

                const result = model.startsWith('models/') ? data.candidates[0].content.parts[0].text : data.choices[0].message.content;
                document.getElementById('reportContent').innerText = result;
                document.getElementById('reportSection').style.display = 'block';
            } catch (e) { alert("‚ö†Ô∏è AI Error: " + e.message); } finally { loader.style.display = 'none'; }
        }

        function copyReport() { navigator.clipboard.writeText(document.getElementById('reportContent').innerText); alert("Copied to clipboard!"); }
    </script>
</body>

</html>